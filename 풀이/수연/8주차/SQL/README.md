### 004 조건에 맞는 도서와 저자 리스트 출력하기
```

SELECT 
   A.BOOK_ID
   , B.AUTHOR_NAME
   , DATE_FORMAT(A.PUBLISHED_DATE, '%Y-%m-%d') AS PUBLISHED_DATE
FROM BOOK A INNER JOIN AUTHOR B
            ON A.AUTHOR_ID = B.AUTHOR_ID
WHERE A.CATEGORY = '경제'      
ORDER BY A.PUBLISHED_DATE

```


### 005 그룹별 조건에 맞는 식당 목록 출력하기
```

SELECT 
  B.MEMBER_NAME
  , A.REVIEW_TEXT, DATE_FORMAT(A.REVIEW_DATE, '%Y-%m-%d') AS REVIEW_DATE
FROM REST_REVIEW AS A INNER JOIN (SELECT S2.MEMBER_ID, S2.MEMBER_NAME, COUNT(S1.REVIEW_ID) AS RE_COUNT
                            FROM REST_REVIEW S1 LEFT OUTER JOIN MEMBER_PROFILE S2
                            ON S1.MEMBER_ID = S2.MEMBER_ID
                            GROUP BY MEMBER_ID
                            ORDER BY RE_COUNT DESC LIMIT 1) AS B
ON A.MEMBER_ID = B.MEMBER_ID
ORDER BY A.REVIEW_DATE, A.REVIEW_TEXT

```


### 006 상품을 구매한 회원 비율 구하기
```

SELECT 
  DATE_FORMAT(A.SALES_DATE, '%Y') AS YEAR
  , CONVERT(DATE_FORMAT(A.SALES_DATE, '%m'), DECIMAL) AS MONTH
  , COUNT(DISTINCT(A.USER_ID)) AS PUCHASED_USERS
  , ROUND(COUNT(DISTINCT(A.USER_ID))/(SELECT COUNT(*) FROM USER_INFO WHERE JOINED BETWEEN '2021-01-01' AND '2021-12-31'), 1)AS PUCHASED_RATIO
FROM ONLINE_SALE A INNER JOIN (SELECT USER_ID
                    FROM USER_INFO
                    WHERE JOINED BETWEEN '2021-01-01' AND '2021-12-31') B
ON A.USER_ID = B.USER_ID
GROUP BY YEAR, MONTH
ORDER BY YEAR, MONTH

```
  
